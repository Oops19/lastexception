<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"/>
		<title>Oops - Another Last Exception lastException.txt</title>
		<meta name="description" content="This tool formats lastException.txt files generated by 'The Sims 4' so they can be read."/>
		<meta name="keywords" content="lastException, sims, 4"/>
		<meta name="author" content="Oops19" />
		<meta name="copyright" content="2022-03 Oops19" />
		<meta name="robots" content="index,follow" />
	</head>
	<body>
		<p>Load Exception <input id='loadException' type='file' /></input></p>
		<textarea id="exception" cols="200" rows="30"></textarea>
		<script>
document.getElementById('loadException').addEventListener('change', loadException, false);
function loadException(e) {
	var file = e.target.files[0];
	if (!file) {
		return;
	};
	var reader = new FileReader();
	reader.onload = function(e) {
		document.getElementById('exception').value = e.target.result.replaceAll('><', '>\r\n<').replaceAll('&#13;&#10;', '\r\n').replaceAll('&lt;', '<').replaceAll('&gt;', '>');
	};
	reader.readAsText(file);
};

document.getElementById('exception').addEventListener('input', formatException, false);
document.getElementById('exception').addEventListener('change', formatException, false);
function formatException() {
	document.getElementById('exception').value = document.getElementById('exception').value.replaceAll('><', '>\r\n<').replaceAll('&#13;&#10;', '\r\n').replaceAll('&#13; &#10;', '\r\n').replaceAll('&lt;', '<').replaceAll('&gt;', '>');
};

document.getElementById('exception').placeholder = "Load a 'lastexception.txt' file or paste the 'lastexception.txt' file contents here.\r\n\r\n\t...\r\n\tEach 'File:' line is part of the stack trace and helpful to identify the issue.\r\n\tFile: ...\r\n\tFile: ...\r\n\tFile: ...\r\n\tFile: ...\r\n\r\nThe error message is one line above and/or below the last 'File:' line.\r\n\r\nExamples:\r\nModuleNotFoundError: No module named 'foo.bar...' - The mod 'foo' is required. If it is installed then you may need to upgrade it. Or you may have duplicates or old copies of it, remove them.\r\n\r\n\r\nPrivacy: The 'uploaded' or 'pasteed' data is handled locally on the client. No data is uploaded or processed on a server. Paranoid users save the page locally and inspect the source code.\r\n\r\nFor further help everything between '<buildsignature>' and '</desyncdata>' can be shared with others.";
		</script>
	</body>
</html>
